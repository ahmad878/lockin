<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Voymind - Plan Your Dream Trip</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <style>
    .gradient-bg {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    .card-hover {
      transition: all 0.3s ease;
    }
    .card-hover:hover {
      transform: translateY(-5px);
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    }
    .loading-spinner {
      border: 3px solid #f3f3f3;
      border-top: 3px solid #667eea;
      border-radius: 50%;
      width: 30px;
      height: 30px;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    .fade-in {
      animation: fadeIn 0.5s ease-in;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body class="bg-gray-50 font-sans">
  <!-- Header -->
  <header class="gradient-bg text-white py-6 shadow-lg">
    <div class="container mx-auto px-4 flex justify-between items-center">
      <div class="flex items-center space-x-3">
        <i class="fas fa-plane-departure text-3xl"></i>
        <h1 class="text-3xl font-bold">Voymind</h1>
      </div>
      <nav class="hidden md:flex space-x-6">
        <a href="#" class="hover:text-blue-200 transition-colors duration-200 font-medium">Home</a>
        <a href="#" class="hover:text-blue-200 transition-colors duration-200 font-medium">About</a>
        <a href="#" class="hover:text-blue-200 transition-colors duration-200 font-medium">Contact</a>
      </nav>
      <div class="md:hidden">
        <i class="fas fa-bars text-xl"></i>
      </div>
    </div>
  </header>

  <!-- Hero Section -->
  <section class="gradient-bg text-white py-24 text-center relative overflow-hidden">
    <div class="absolute inset-0 bg-black opacity-20"></div>
    <div class="container mx-auto px-4 relative z-10">
      <div class="max-w-4xl mx-auto">
        <h2 class="text-5xl md:text-6xl font-bold mb-6 leading-tight">
          Plan Your <span class="text-yellow-300">Dream Trip</span> with AI
        </h2>
        <p class="text-xl md:text-2xl mb-8 text-blue-100 leading-relaxed">
          Discover the perfect hotels, flights, guides, and activities tailored to your budget and preferences
        </p>
        <div class="flex flex-wrap justify-center gap-4 text-sm">
          <div class="bg-white bg-opacity-20 px-4 py-2 rounded-full">
            <i class="fas fa-hotel mr-2"></i>Best Hotels
          </div>
          <div class="bg-white bg-opacity-20 px-4 py-2 rounded-full">
            <i class="fas fa-plane mr-2"></i>Smart Flights
          </div>
          <div class="bg-white bg-opacity-20 px-4 py-2 rounded-full">
            <i class="fas fa-map-marked-alt mr-2"></i>Local Guides
          </div>
          <div class="bg-white bg-opacity-20 px-4 py-2 rounded-full">
            <i class="fas fa-camera mr-2"></i>Amazing Activities
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Form Section -->
  <section class="py-16 -mt-8">
    <div class="container mx-auto px-4">
      <div class="max-w-2xl mx-auto bg-white rounded-2xl shadow-2xl card-hover">
        <div class="bg-gradient-to-r from-blue-600 to-purple-600 text-white p-8 rounded-t-2xl">
          <h3 class="text-3xl font-bold text-center">Start Your Adventure</h3>
          <p class="text-center mt-2 text-blue-100">Tell us about your dream trip</p>
        </div>
        
        <form id="tripForm" class="p-8 space-y-6">
          <!-- Destination -->
          <div class="space-y-2">
            <label class="block text-sm font-semibold text-gray-700 flex items-center">
              <i class="fas fa-map-marker-alt text-blue-600 mr-2"></i>
              Destination
            </label>
            <input
              type="text"
              name="destination"
              placeholder="e.g., Paris, France"
              class="w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 text-lg"
              required
            />
            <div class="mt-2">
              <span class="text-sm text-gray-500">
                Not sure where to go? 
                <a href="#" class="text-blue-600 hover:text-blue-800 font-semibold underline">Try our Place Finder!</a>
              </span>
            </div>
          </div>

          <!-- Departure -->
          <div class="space-y-2">
            <label class="block text-sm font-semibold text-gray-700 flex items-center">
              <i class="fas fa-home text-blue-600 mr-2"></i>
              Your Current City
            </label>
            <input
              type="text"
              name="departure"
              placeholder="e.g., New York, NY"
              class="w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 text-lg"
              required
            />
          </div>

          <!-- Dates -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="space-y-2">
              <label class="block text-sm font-semibold text-gray-700 flex items-center">
                <i class="fas fa-calendar-check text-green-600 mr-2"></i>
                Check-In Date
              </label>
              <input
                type="date"
                name="checkIn"
                class="w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"
                required
              />
            </div>
            <div class="space-y-2">
              <label class="block text-sm font-semibold text-gray-700 flex items-center">
                <i class="fas fa-calendar-times text-red-600 mr-2"></i>
                Check-Out Date
              </label>
              <input
                type="date"
                name="checkOut"
                class="w-full p-4 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"
                required
              />
            </div>
          </div>

          <!-- Budget -->
          <div class="space-y-2">
            <label class="block text-sm font-semibold text-gray-700 flex items-center">
              <i class="fas fa-dollar-sign text-green-600 mr-2"></i>
              Total Budget (USD)
            </label>
            <div class="relative">
              <span class="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-500">$</span>
              <input
                type="number"
                name="budget"
                placeholder="e.g., 2500"
                class="w-full p-4 pl-8 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 text-lg"
              />
            </div>
            <p class="text-sm text-gray-500">Including flights, accommodation, and activities</p>
          </div>

          <!-- Include Options -->
          <div class="space-y-4">
            <label class="block text-sm font-semibold text-gray-700">
              <i class="fas fa-list-check text-blue-600 mr-2"></i>
              Include in Search
            </label>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div class="flex items-center p-4 border-2 border-gray-200 rounded-xl hover:border-blue-300 transition-all duration-200 cursor-pointer" onclick="toggleCheckbox('includeHotels')">
                <input
                  type="checkbox"
                  name="includeHotels"
                  id="includeHotels"
                  checked
                  class="h-5 w-5 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
                />
                <label class="ml-3 text-sm font-medium text-gray-700 cursor-pointer flex items-center">
                  <i class="fas fa-hotel text-blue-600 mr-2"></i>
                  Hotels
                </label>
              </div>
              
              <div class="flex items-center p-4 border-2 border-gray-200 rounded-xl hover:border-blue-300 transition-all duration-200 cursor-pointer" onclick="toggleCheckbox('includeFlights')">
                <input
                  type="checkbox"
                  name="includeFlights"
                  id="includeFlights"
                  checked
                  class="h-5 w-5 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
                />
                <label class="ml-3 text-sm font-medium text-gray-700 cursor-pointer flex items-center">
                  <i class="fas fa-plane text-blue-600 mr-2"></i>
                  Flights
                </label>
              </div>
              
              <div class="flex items-center p-4 border-2 border-gray-200 rounded-xl hover:border-blue-300 transition-all duration-200 cursor-pointer" onclick="toggleCheckbox('includeGuides')">
                <input
                  type="checkbox"
                  name="includeGuides"
                  id="includeGuides"
                  class="h-5 w-5 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
                />
                <label class="ml-3 text-sm font-medium text-gray-700 cursor-pointer flex items-center">
                  <i class="fas fa-user-tie text-blue-600 mr-2"></i>
                  Local Guides
                </label>
              </div>
              
              <div class="flex items-center p-4 border-2 border-gray-200 rounded-xl hover:border-blue-300 transition-all duration-200 cursor-pointer" onclick="toggleCheckbox('includePlaces')">
                <input
                  type="checkbox"
                  name="includePlaces"
                  id="includePlaces"
                  class="h-5 w-5 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
                />
                <label class="ml-3 text-sm font-medium text-gray-700 cursor-pointer flex items-center">
                  <i class="fas fa-map-marked-alt text-blue-600 mr-2"></i>
                  Places & Activities
                </label>
              </div>
            </div>
            
            <div id="includeError" class="hidden bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg">
              <div class="flex items-center">
                <i class="fas fa-exclamation-triangle mr-2"></i>
                <span class="font-medium">You must select at least one option to include in search.</span>
              </div>
            </div>
          </div>

          <!-- Submit Button -->
          <button
            type="submit"
            id="submitBtn"
            class="w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-4 rounded-xl hover:from-blue-700 hover:to-purple-700 transition-all duration-200 font-semibold text-lg shadow-lg hover:shadow-xl transform hover:-translate-y-1"
          >
            <span id="submitText">
              <i class="fas fa-search mr-2"></i>
              Find My Perfect Trip
            </span>
            <div id="loadingSpinner" class="loading-spinner mx-auto hidden"></div>
          </button>
        </form>
      </div>
    </div>
  </section>

  <!-- Results Section -->
  <section id="resultsSection" class="py-16 hidden">
    <div class="container mx-auto px-4">
      <div class="max-w-4xl mx-auto">
        <div class="bg-white rounded-2xl shadow-2xl overflow-hidden">
          <div class="bg-gradient-to-r from-green-600 to-blue-600 text-white p-8">
            <h3 class="text-3xl font-bold text-center">Your Trip Results</h3>
            <p class="text-center mt-2 text-green-100">Here's your personalized travel plan</p>
          </div>
          <div id="resultsContent" class="p-8">
            <!-- Results will be populated here -->
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="bg-gray-900 text-white py-12">
    <div class="container mx-auto px-4">
      <div class="text-center">
        <div class="flex justify-center items-center mb-4">
          <i class="fas fa-plane-departure text-2xl mr-3"></i>
          <h3 class="text-2xl font-bold">Voymind</h3>
        </div>
        <p class="text-gray-400 mb-4">Making your travel dreams come true with AI-powered planning</p>
        <div class="flex justify-center space-x-6 text-gray-400">
          <a href="#" class="hover:text-white transition-colors"><i class="fab fa-twitter text-xl"></i></a>
          <a href="#" class="hover:text-white transition-colors"><i class="fab fa-facebook text-xl"></i></a>
          <a href="#" class="hover:text-white transition-colors"><i class="fab fa-instagram text-xl"></i></a>
        </div>
        <p class="mt-6 text-gray-500">Â© 2025 Voymind. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <script>
  function toggleCheckbox(id) {
    const checkbox = document.getElementById(id);
    checkbox.checked = !checkbox.checked;
    validateCheckboxes();
  }

  function validateCheckboxes() {
    const includeHotels = document.getElementById('includeHotels').checked;
    const includeFlights = document.getElementById('includeFlights').checked;
    const includeGuides = document.getElementById('includeGuides').checked;
    const includePlaces = document.getElementById('includePlaces').checked;
    const includeError = document.getElementById('includeError');

    if (!includeHotels && !includeFlights && !includeGuides && !includePlaces) {
      includeError.classList.remove('hidden');
      return false;
    } else {
      includeError.classList.add('hidden');
      return true;
    }
  }

  function formatMarkdown(text) {
    // Bold
    text = text.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
    // Links
    text = text.replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<a href="$2" target="_blank" class="text-blue-600 underline hover:text-blue-800">$1</a>');
    // Numbered lists
    text = text.replace(/(^|\n)\s*\d+\. (.*?)(?=\n\s*\d+\.|\n\s*- |\n|$)/gs, function(match, p1, p2) {
      return `${p1}<li class='mb-2'>${p2.trim()}`;
    });
    // Dash lists
    text = text.replace(/(^|\n)\s*- (.*?)(?=\n\s*- |\n\s*\d+\.|\n|$)/gs, function(match, p1, p2) {
      return `${p1}<li class='mb-2'>${p2.trim()}`;
    });
    // Wrap consecutive <li> in <ul>
    text = text.replace(/((<li[\s\S]*?<\/li>?\s*)+)/g, function(match) {
      return `<ul class='list-disc pl-6 my-2'>${match}</ul>`;
    });
    // Step-by-step sub-lists (numbered)
    text = text.replace(/Step-by-Step:\s*<ul[^>]*>([\s\S]*?)<\/ul>/g, function(match, steps) {
      return `<div class='font-semibold mb-1'>Step-by-Step:</div><ol class='list-decimal pl-8 my-2'>${steps.replace(/<li/g, '<li class="mb-1"')}</ol>`;
    });
    return text;
  }

  function parseSections(markdown) {
    // Split by #### or ### headings
    const sectionRegex = /(####?\s+.*)/g;
    const parts = markdown.split(sectionRegex).filter(Boolean);
    let sections = [];
    let current = null;
    for (let part of parts) {
      if (/^####?\s+/.test(part)) {
        if (current) sections.push(current);
        current = { title: part.replace(/^####?\s+/, '').trim(), content: '' };
      } else if (current) {
        current.content += part;
      }
    }
    if (current) sections.push(current);
    return sections;
  }

  function showResults(data) {
    const resultsSection = document.getElementById('resultsSection');
    const resultsContent = document.getElementById('resultsContent');
    let html = '';

    // If the response is a string, parse and format it
    if (typeof data === 'string' || (data && typeof data.response === 'string')) {
      const responseText = typeof data === 'string' ? data : data.response;
      // Remove any leading 'Response:'
      const cleanText = responseText.replace(/^Response:\s*/i, '');
      const sections = parseSections(cleanText);
      html = '<div class="space-y-8">';
      for (const section of sections) {
        html += `
          <div class="border rounded-xl shadow p-6 bg-gray-50 fade-in">
            <h4 class="text-2xl font-bold text-blue-700 mb-3">${section.title}</h4>
            <div class="text-gray-700 leading-relaxed text-lg">${formatMarkdown(section.content)}</div>
          </div>
        `;
      }
      html += '</div>';
    } else if (typeof data === 'object') {
      // fallback: show as JSON
      html = `<pre>${JSON.stringify(data, null, 2)}</pre>`;
    }

    resultsContent.innerHTML = html;
    resultsSection.classList.remove('hidden');
    resultsSection.scrollIntoView({ behavior: 'smooth' });
  }

  document.getElementById('tripForm').addEventListener('submit', async function(event) {
    event.preventDefault();
    
    if (!validateCheckboxes()) {
      return;
    }

    const submitBtn = document.getElementById('submitBtn');
    const submitText = document.getElementById('submitText');
    const loadingSpinner = document.getElementById('loadingSpinner');

    // Show loading state
    submitText.classList.add('hidden');
    loadingSpinner.classList.remove('hidden');
    submitBtn.disabled = true;

    const formData = {
      destination: this.destination.value,
      departure: this.departure.value,
      checkIn: this.checkIn.value,
      checkOut: this.checkOut.value,
      budget: this.budget.value,
      includeHotels: this.includeHotels.checked,
      includeFlights: this.includeFlights.checked,
      includeGuides: this.includeGuides.checked,
      includePlaces: this.includePlaces.checked
    };

    try {
      const response = await fetch('/', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(formData)
      });

      if (response.ok) {
        const data = await response.json();
        showResults(data);
      } else {
        throw new Error('Server error');
      }
    } catch (error) {
      console.error('Error:', error);
      alert('There was an error processing your request. Please try again.');
    } finally {
      // Reset loading state
      submitText.classList.remove('hidden');
      loadingSpinner.classList.add('hidden');
      submitBtn.disabled = false;
    }
  });

  // Add event listeners for checkbox validation
  document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
    checkbox.addEventListener('change', validateCheckboxes);
  });
  </script>
</body>
</html>